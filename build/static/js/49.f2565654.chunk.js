"use strict";(self.webpackChunkcalendar_cart_srd_wlkp=self.webpackChunkcalendar_cart_srd_wlkp||[]).push([[49],{8049:function(e,t,a){a.r(t),a.d(t,{default:function(){return C}});var n=a(9439),r=a(6459),l=a(2791),s=a(8997),o=a(7689),i=a(4123),c=a(8301);var d=function(){return(0,l.useContext)(c.Z)},u=a(3474),f=a(807),h=a(1694),m=a.n(h),p=a(184);function x(e){var t=e.displayedMonth,a=e.setDisplayedMonth,n=e.monthsCountForMonthCarousel;return(0,p.jsxs)("div",{className:"bg-blue-400 w-full h-10 flex justify-start",children:[(0,p.jsx)("button",{className:m()("py-2 px-4  text-white",0===t?"bg-gray-500 cursor-default":"bg-blue-500 hover:bg-blue-600 cursor-pointer"),onClick:function(){a((t-1+n)%n)},disabled:0===t,children:"Poprzedni miesi\u0105c"}),(0,p.jsx)("button",{className:m()("py-2 px-4 rounded-r-md text-white",t===n-1?"bg-gray-500 cursor-default":"bg-blue-500 hover:bg-blue-600 cursor-pointer"),onClick:function(){a((t+1)%n)},disabled:t===n-1,children:"Nast\u0119pny miesi\u0105c"})]})}var b=a(1413),v=a(8473),y=a(4925);function g(e){var t=e.dayDate,a=e.day,n=e.slots,r=e.isBlank;return(0,p.jsxs)("div",{className:"h-20 w-40 flex-none border-b-2 border-black ".concat(r?"bg-gray-300":"bg-amber-200"," flex flex-col"),children:[(0,p.jsxs)("div",{className:"flex flex-col  justify-center items-center",children:[(0,p.jsx)("span",{className:"font-semibold",children:a}),(0,p.jsx)("span",{children:t})]}),!r&&(0,p.jsx)("div",{className:"flex flex-row w-full h-full overflow-hidden",children:n.map((function(e,t){return(0,p.jsx)("span",{className:"w-full h-full justify-center items-center overflow-hidden flex flex-wrap text-center border-2 break-words border-red-200",children:e.name},t)}))})]})}var w=a(9045);function I(e){var t=e._thisSlot,a=e.dayDate,r=d(),s=(r.updateSlot,r.updateSlotsArray),o=r.emitMessage,c=(0,l.useState)(t),u=(0,n.Z)(c,2),f=u[0],h=u[1],m=(0,w.Z)().user,x=(0,i.Z)().setMessage;(0,l.useMemo)((function(){t.handleSign=h,s([t])}),[]);var y=(0,i.Z)().setConfirm,g=f.sign,I=function(e){if(e){var t=(0,b.Z)((0,b.Z)({},f),{},{sign:m.name});D(t)}},j=function(e){if(e){var t=(0,b.Z)((0,b.Z)({},f),{},{sign:""});D(t),x("Zosta\u0142e\u015b wypisany!")}},D=function(e){o(e),x("Zosta\u0142e\u015b zapisany!"),h(e)},Z={entering:{opacity:1,transform:"translateX(0)"},entered:{opacity:1,transform:"translateX(0)"},exiting:{opacity:0,transform:"translateX(-50%)"},exited:{opacity:0,transform:"translateX(-50%)"}},k=(0,v.Yz)(""!==g,{from:{opacity:0,transform:"translateX(-50%)",display:"inline-block"},enter:Z.entering,leave:Z.exiting,config:{duration:300}});return(0,p.jsx)("button",{className:"overflow-hidden w-full h-full border-2 border-red-200 duration-150 hover:backdrop-brightness-90 text-center active:bg-red-300\n        ".concat("","\n        ").concat(g!==m.name&&""!==g?"cursor-not-allowed pointer-events-none":"","\n      "),onClick:function(e){if(e.preventDefault(),g===m.name){var t="Czy na pewno chcesz wypisa\u0107 si\u0119 z dnia ".concat(f.day.toLowerCase()," ").concat(a,", godzina ").concat(f.time,"?");y({message:t,submit:"Wypisz mnie",handleSubmit:j})}else{var n="Czy na pewno chcesz zapisa\u0107 si\u0119 na ".concat(f.time," w ").concat(f.day.toLowerCase()," ").concat(a,"?");y({message:n,submit:"Zapisz mnie",handleSubmit:I})}},children:k((function(e,t){return t&&(0,p.jsx)(v.q.span,{style:e,children:g})}))})}var j=["day","isActive","isBlank","timeArr","date","weekIndex","dayDate","calendar"];function D(e){var t,a=e.day,n=(e.isActive,e.isBlank),r=e.timeArr,s=e.date,o=e.weekIndex,i=e.dayDate,c=e.calendar,u=((0,y.Z)(e,j),c._id),f=c.name,h=c.slots,m=c.records,x=d().handleRecords,b=u,v=d().removeAllSlots;(0,l.useEffect)((function(){return x(m),function(){v()}}),[]),i&&(t=function(e){var t=e,a=t.getDate().toString().padStart(2,"0"),n=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getFullYear().toString();return"".concat(a,".").concat(n,".").concat(r)}(i));var w=(0,l.useMemo)((function(){return!n&&(0,p.jsx)(p.Fragment,{children:r.map((function(e,n){return(0,p.jsx)("div",{className:"flex flex-row w-full h-full border-b-2 border-black",children:h.map((function(n){for(var r=[],l=0;l<n.space;l++){var i=f+a+n.name+e+l,c={calendar:f,date:s,weekIndex:o,day:a,time:e,slotName:n.name,slotIndex:l,sign:"",calendarID:b};r.push((0,p.jsx)(I,{dayDate:t,_thisSlot:c},i))}return(0,p.jsx)("div",{className:"flex flex-col w-full h-full order-".concat(n.order," overflow-hidden"),children:r},n.name)}))},n)}))})}),[]);return(0,p.jsxs)("div",{className:"flex flex-col w-full ".concat(n?"bg-gray-400 ":"bg-amber-100","  border-l-2 border-black "),children:[(0,p.jsx)(g,{dayDate:t,day:a,slots:h,isBlank:n}),w]},a)}var Z=["timeArr"];function k(e){var t=e.timeArr;(0,y.Z)(e,Z);return(0,p.jsxs)("div",{className:"flex w-full flex-col bg-white",children:[(0,p.jsx)("div",{className:"h-20 border-b-2 border-black "}),t.map((function(e,t){return(0,p.jsx)("div",{className:"bg-white flex w-10 h-10 flex-1 border-b-2 border-black items-center justify-center",time:e,children:e},e)}))]})}function M(e){e.allDaysInMonth,e.allDaysLeftInMonth,e.allWeeksInMonth;var t=e.allWeeksLeftInMonth,a=e.calendar,r=e.date,s=a.time,o=(a.name,a.slots,["PONIEDZIA\u0141EK","WTOREK","\u015aRODA","CZWARTEK","PI\u0104TEK","SOBOTA","NIEDZIELA"]),i=(0,l.useState)(function(e,t,a){for(var r=[],l=e;l<=t;){r.push(l);var s=l.split(":"),o=(0,n.Z)(s,2),i=o[0],c=o[1],d=60*parseInt(i)+parseInt(c)+(60*parseInt(a.split(":")[0])+parseInt(a.split(":")[1])),u=Math.floor(d/60).toString().padStart(2,"0"),f=d%60;l="".concat(u,":").concat(f.toString().padStart(2,"0"))}return r}(s.timeFrom,s.timeTo,s.timeSpace)),c=(0,n.Z)(i,2),d=c[0],u=(c[1],m()("w-full h-full overflow-y-scroll overflow-x-scroll snap snap-y snap-mandatory"));return(0,p.jsx)("div",{className:u,children:t.map((function(e,n){return 0!==e.length&&(0,p.jsxs)("section",{className:"snap-start h-full w-full bg-gray-100 flex flex-row",children:[(0,p.jsx)(k,{timeArr:d}),o.map((function(l,s){for(var o,i,c,u=!1,f=0;f<e.length;f++){var h=e[f];if(h.day.toUpperCase()===l){u=!0,c=h.date;break}}return u?(0,p.jsx)(D,{day:l,dayDate:c,isActive:!(null===(o=t[n])||void 0===o||!o[s]),isBlank:!1,timeArr:d,date:r,weekIndex:n,calendar:a},s):(0,p.jsx)(D,{day:l,isActive:!(null===(i=t[n])||void 0===i||!i[s]),isBlank:!0,calendar:a},s)}))]},n)}))})}function N(e){var t=e.calendar,a=e.date,r=(m()(""),(new Date).getFullYear(),a.split(".")),l=(0,n.Z)(r,2),s=(l[0],l[1],["STYCZE\u0143","LUTY","MARZEC","KWIECIE\u0143","MAJ","CZERWIEC","LIPIEC","SIERPIE\u0143","WRZESIE\u0143","PA\u0179DZIERNIK","LISTOPAD","GRUDZIE\u0143"]),o=["NIEDZIELA","PONIEDZIA\u0141EK","WTOREK","\u015aRODA","CZWARTEK","PI\u0104TEK","SOBOTA"];var i=function(e){for(var t=e.split("."),a=(0,n.Z)(t,2),r=a[0],l=a[1],i=s.indexOf(r.toUpperCase()),c=parseInt(l,10),d=new Date(c,i+1,0).getDate(),u=new Date,f=(u.getFullYear(),u.getMonth(),u.getDate(),new Date(c,i,1).getDay(),[]),h=[],m=[],p=[],x=1;x<=d;x++){var b=new Date(c,i,x),v={day:o[b.getDay()],date:b};f.push(v),b>u?h.push(v):h.push(!1)}for(var y=[],g=[],w=1;w<=d;w++){var I=new Date(c,i,w),j=I.getDay();1===j&&(m.push(y),p.push(g),y=[],g=[]);var D={day:o[j],date:I};y.push(D),I>u&&g.push(D)}return y.length>0&&(m.push(y),p.push(y)),{allDaysInMonth:f,allDaysLeftInMonth:h,allWeeksInMonth:m.filter((function(e){return e.length>0})),allWeeksLeftInMonth:p}}(a),c=i.allDaysInMonth,d=i.allDaysLeftInMonth,u=i.allWeeksInMonth,f=i.allWeeksLeftInMonth;return(0,p.jsxs)("div",{className:"w-full h-full",children:[(0,p.jsx)("h3",{className:"flex justify-center items-center p-2 border-b-2 border-black font-semibold",children:a}),(0,p.jsx)(M,{allDaysInMonth:c,allDaysLeftInMonth:d,allWeeksInMonth:u,allWeeksLeftInMonth:f,calendar:t,date:a})]})}function S(e){var t=e.calendar,a=e.displayedMonth,r=e.monthsCountForMonthCarousel,s=t.date,o=(0,l.useMemo)((function(){return s.map((function(e,a){return(0,p.jsx)(N,{calendar:t,date:s[a]})}))}),[]),i=(0,l.useState)(o),c=(0,n.Z)(i,2),d=c[0],u=(c[1],(0,v.bY)(r,s.map((function(e,t){return{transform:"translateX(".concat(100*(t-a),"%)"),position:"absolute",width:"full",height:"full",top:0,left:0,zIndex:t===a?1:0}}))));return(0,p.jsx)("div",{className:"relative w-full h-full",children:u.map((function(e,t){return(0,p.jsx)(v.q.div,{className:"absolute w-full h-full pb-[72px]",style:(0,b.Z)({},e),children:d?d[t]:null},t)}))})}var E=a(2599),A=a(4937);function C(e){(0,r.Z)(e);var t=(0,i.Z)(),a=t.calendars,c=t.navigate,h=t.confirm,m=t.isFetching,b=t.message,v=(0,o.UO)().calendarName,y=(0,l.useMemo)((function(){for(var e=0;e<a.length;e++){var t=a[e],n=t.name.replaceAll(" ","_").normalize("NFD").replace(/[\u0300-\u036f]/g,"");if(v===n)return t}return!1}),[m]),g=(0,l.useState)(y),w=(0,n.Z)(g,2),I=w[0],j=w[1];(0,l.useEffect)((function(){setTimeout((function(){y||m||c("/brak_strony"),j(y)}),1e3)}),[m]);var D=(0,l.useState)(0),Z=(0,n.Z)(D,2),k=Z[0],M=Z[1],N=d(),C=N.slotsArray,W=N.removeAllSlots;if((0,l.useEffect)((function(){return function(){0!==C.length&&W()}}),[]),!I)return(0,p.jsx)(E.Z,{});var L=I.name,z=I.date.length;return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)(s.E.div,{className:" absolute inset-0 flex items-center flex-col bg-red-100",variants:{hidden:{opacity:0,x:-200,y:0},enter:{opacity:1,x:0,y:0},exit:{opacity:0}},initial:"hidden",animate:"enter",transition:{type:"linear"},exit:"exit",children:[(0,p.jsx)(f.Z,{message:h.message,submit:h.submit,handleSubmit:h.handleSubmit}),(0,p.jsx)(A.Z,{message:b,theme:"bg-yellow-100"}),(0,p.jsx)(u.Z,{calendarName:L,theme:"bg-red-300"}),(0,p.jsxs)("div",{className:"mt-4 w-[95%] h-[90%] md:mt-6 md:max-w-[90%] md:[90%] bg-red-300 md:mx-auto overflow-x-hidden rounded-sm text-xs overflow-hidden border-2 border-black",children:[(0,p.jsx)(x,{displayedMonth:k,setDisplayedMonth:M,monthsCountForMonthCarousel:z}),(0,p.jsx)(S,{calendar:I,monthsCountForMonthCarousel:z,displayedMonth:k})]})]})})}}}]);
//# sourceMappingURL=49.f2565654.chunk.js.map