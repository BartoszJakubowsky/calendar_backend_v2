import{r as i,j as e,A as _,a as B,F as q,S as Q,u as X,t as E,m as J,I as Y,L as y,b as T,c as I,d as G,e as ee,f as te,g as ae,h as se,M as re,C as ne}from"./index-19caf8a9.js";function W({modalText:t,buttonText:o,onClick:a,isOpen:d,setIsOpen:m,onlyButton:f=!0}){const l={type:"spring",stiffness:700,damping:30};i.useEffect(()=>{const r=n=>{n.keyCode===27&&s()};return window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)}},[]);const u=()=>{a&&a(),m(!1)},s=()=>{f||m(!1)};return e.jsx(_,{mode:"wait",children:d?e.jsx(B,{onClick:s,animation:"opacityVariant",transition:{duration:.2},className:"fixed inset-0 bg-opacity-80 duration-200 transition-all bg-gray-900 z-50 flex justify-center items-center",children:e.jsxs(B,{transition:l,animation:"scaleVariant",className:"relative w-80 rounded-sm h-60 bg-red-100 mb-3/4 background p-4 overflow-hidden text-lg flex flex-wrap flex-col",children:[t,e.jsx(q,{onClick:u,text:o,className:"!w-fit !self-end mt-auto mb-2"})]})}):!1})}function oe({days:t,bannedData:o,rowClassName:a,cellClassName:d,additionalFirstCol:m,translate:f}){const l=t.filter(s=>!o.includes(s.name.toUpperCase())),u=l.length>0?l.map(s=>{if(s.erase||(b=>{const p=b.toUpperCase();return o.includes(p)})(s.name))return!1;const n=s.date.split("T")[0].split("-").reverse().join("-");return e.jsxs("th",{className:`${d} flex flex-col grow bg-accentMedium dark:bg-dark-accentMedium text-dark-baseColor dark:text-baseColor font-medium`,children:[e.jsx("h3",{className:"pb-1",children:f(s.name)}),e.jsx("h4",{children:n}),e.jsx("div",{className:"flex justify-evenly overflow-hidden",children:s.columns.map(b=>e.jsx("h4",{className:"h-14 w-16 text-sm text-center",children:b.name},b.id))})]},s.id)}):!1;return e.jsx(e.Fragment,{children:u?e.jsxs("tr",{className:`${a} sticky top-0 z-[6]`,children:[m?e.jsx("th",{className:`${d}  sticky -left-[1px] w-16  bg-accentLight dark:bg-dark-accentLight text-dark-baseColor dark:text-baseColor`,children:f(m)}):!1,u]}):!1})}function K(){return i.useContext(Q)}function le({record:t,translate:o,calendarId:a}){const{user:d}=X(),{socket:m,updateRecord:f}=K(),[l,u]=i.useState(t.data),s=t.id,[r,n]=i.useState(!1),b=c=>{c.recordId===s&&u(c.data)};i.useEffect(()=>{m&&m.on("sign",c=>b(c))},[]);const p=()=>{n(o(l===""?"sign":"sign_out"))},h=()=>{n(!1)},g=()=>{f({recordId:s,calendarId:a,data:l===""?d.name:""}),l===""?n(!1):p()};return e.jsx("button",{className:`${l===""?"dark:bg-dark-accentLight bg-accentLight ":"bg-accentMedium dark:bg-dark-accentMedium"}
         hover:bg-accentMedium dark:hover:bg-dark-accentStrongHover w-24 h-14 hover:shadow-lg transition-all active:bg-accentStrong dark:active:bg-dark-accentStrong active:text-baseColor duration-200 grow rounded-sm border-[1px] border-slate-700 m-1 overflow-hidden`,onMouseEnter:p,onMouseLeave:h,onClick:g,children:r||l})}function U({message:t,hide:o,...a}){if(o)return!1;const d=t.data,m=t.date,f=t.time;function l(s){const r=new Date("2023-08-31T22:00:00.000Z"),n=new Date(s);if(f){const[b,p]=f.split(":");n.inputDateTime.setUTCHours(b,p,0,0)}return n<r}return d==""||m&&l(m)?!1:e.jsx("div",{className:`${a.className?a.className:""} z-[1] inset-0 absolute flex justify-center items-center bg-accentMedium dark:a rounded-md border-2 border-accentStrong dark:border-dark-accentStrong`,children:e.jsx("p",{className:`${a.className?"":"sticky top-1/4 bottom-1/2 left-1/4 -translate-x-1/4"} text-center`,children:d})})}function ce({days:t,bannedDays:o,rowClassName:a,cellClassName:d,time:m,translate:f,index:l,calendarId:u,weekMessage:s}){const r=g=>g.map(c=>e.jsx(le,{record:c,translate:f,calendarId:u},c.id)),n=g=>{const c=g.map((x,k)=>{if(k===l)return e.jsx("div",{className:"flex flex-col items-center justify-center relative",children:r(x.records)},x.id)});return e.jsx(e.Fragment,{children:c})},b=g=>g.map(c=>e.jsxs("div",{className:"flex relative",children:[c.messages.length>0&&e.jsx(U,{className:"flex z-[2]",message:c.messages[0],isVisible:s}),n(c.slots)]},c.id)),p=t.filter(g=>!o.includes(g.name.toUpperCase())),h=p.length>0?p.map(g=>g.erase?!1:e.jsxs("td",{className:`${d} flex flex-row grow relative`,children:[g.messages.length>0&&e.jsx(U,{className:"flex z-[3]",message:g.messages[0],hide:s}),b(g.columns)]},g.id)):!1;return e.jsx(e.Fragment,{children:h?e.jsxs("tr",{className:`${a} relative`,children:[e.jsx("td",{className:`${d}border-l-0 border-r-2 sticky z-[5] -left-[1px] w-16 bg-accentLight dark:bg-dark-accentLight text-dark-baseColor dark:text-baseColor justify-center flex items-center`,children:e.jsx("span",{className:"sticky top-28",children:m})}),h]}):!1})}function ie({week:t,calendarId:o}){const{days:a,bannedDays:d,time:m,messages:f,erase:l}=t;return l?!1:e.jsxs("table",{className:"relative",children:[f.length>0&&e.jsx(U,{message:f[0]}),e.jsxs("tbody",{children:[e.jsx(oe,{rowClassName:"flex flex-row",cellClassName:"bg-accentLight dark:bg-accentLight border-2 border-slate-700",days:a,bannedData:d,additionalFirstCol:"time",translate:E}),m.map((u,s)=>e.jsx(ce,{index:s,rowClassName:"flex flex-row",cellClassName:"bg-accentLight dark:bg-dark-accentLight border-2 border-slate-700 text-dark-baseColor dark:text-baseColor",days:a,bannedDays:d,time:u,translate:E,calendarId:o,weekMessage:f.length>0},u))]})]})}function de({month:t,swipe:o,setSwipe:a,maxIndex:d,calendarId:m}){const[f,l]=t.name.split(".").map(b=>b.toLowerCase()),u=t.messages.map((b,p)=>e.jsx(U,{message:b},p)),s=()=>{a(o-1)},r=()=>{a(o+1)},n=t.weeks.map((b,p)=>e.jsx(ie,{week:b,calendarId:m},p));return e.jsxs("div",{className:"overflow-hidden w-full h-full border-2 border-slate-700 relative",children:[u,e.jsxs("h3",{className:"relative text-lg w-full md:h-[4%] h-[5%] text-center bg-accentStrongHover dark:bg-dark-accentStrongHover text-baseColor dark:text-baseColor",children:[E(l),e.jsx("button",{onClick:s,className:`absolute text-sm left-1 top-1 transition-all duration-200 ${o===0?" opacity-50 pointer-events-none":""}`,children:E("previousMonth")}),e.jsx("button",{onClick:r,className:`absolute text-sm right-1 top-1 transition-all duration-200 ${o===d?"opacity-50 pointer-events-none":""}`,children:E("nextMonth")})]}),e.jsx("div",{className:"flex flex-wrap flex-col md:h-[96%] h-[95%] w-full overflow-auto touch-auto bg-red-300",children:n})]})}function ue({children:t,...o}){var r,n;const a=i.useRef(null),d=(r=a==null?void 0:a.current)!=null&&r.clientHeight?a.current.clientHeight:0,m=(n=a==null?void 0:a.current)!=null&&n.clientWidth?a.current.clientWidth:0,[f,l]=i.useState(!1),u=b=>{a.current.style.width=`${(f||m)-b}px`},s=()=>{l(a.current.clientWidth)};return e.jsxs(J.div,{ref:a,className:o.className,drag:!0,dragConstraints:{top:0,left:0,right:0,bottom:window.innerHeight-d},dragMomentum:!1,dragElastic:.05,children:[t,e.jsx(me,{className:"absolute bottom-1/2 top-1/2 left-1",handleDragEnd:s,handleResize:u})]})}function me({handleResize:t,handleDragEnd:o,...a}){let d;return e.jsx(J.div,{className:a.className,drag:!0,dragConstraints:{left:0,right:0,top:0,bottom:0},dragMomentum:!1,dragElastic:.01,onDragEnd:()=>o(),onDrag:(m,f)=>{const l=()=>{const s=f.offset.x;return d===s?!1:s};(()=>{const s=l();s&&(d=s,t(s,"x"))})()},children:e.jsx(Y,{className:" rotate-90 cursor-ew-resize"})})}function $({messages:t,setMessages:o,boundaryArray:a,maxMessages:d,translate:m,...f}){const l=(r,n)=>{const b=t.map((p,h)=>h!==n?p:r);o(b)},u=()=>{const r={data:"",expires:{date:"",time:""},from:a?0:!1,to:a?a.length-1:!1};t.length===0?o([r]):o([...t,r])},s=r=>{o(t.filter((n,b)=>b!==r))};return e.jsxs("div",{className:`${f.className}`,children:[t.length>0&&t.map((r,n)=>{const b=x=>{const k={...r,data:x};l(k,n)},p=x=>{const k={...r,expires:{...r.expires,date:x}};l(k,n)},h=x=>{const k={...r,expires:{...r.expires,time:x}};l(k,n)},g=x=>{const k=a.indexOf(x),v={...r,from:k};l(v,n)},c=x=>{const k=a.indexOf(x),v={...r,to:k};l(v,n)};return e.jsxs("div",{className:"flex w-full flex-row",children:[e.jsxs("div",{className:"relative w-2/3  mr-2 mb-2",children:[e.jsx(y,{inputType:"textarea",inputContainerClassName:"w-full h-full relative min-w-[full]",inputClassName:"h-full",value:r.data,setValue:b,placeHolder:m("monthMessagePlaceholder")}),e.jsx("button",{onClick:()=>s(n),className:"flex justify-center absolute right-1 top-3 button-form-reject w-6 h-6 rounded-sm text:dark-baseColor dark:text-baseColor",children:"-"})]}),e.jsxs("div",{className:"flex flex-col w-1/3",children:[e.jsx(y,{inputType:"date",inputClassName:"w-full",value:r.expires.date,setValue:p}),e.jsx(y,{inputType:"time",inputClassName:"w-full",value:r.expires.time,setValue:h}),a?e.jsxs("div",{className:"flex w-full h-10",children:[e.jsx(y,{inputType:"list",inputContainerClassName:"mr-1",valueList:a,value:0,setValue:g}),e.jsx(y,{inputType:"list",inputContainerClassName:"ml-1",valueList:a,value:a.length-1,setValue:c})]}):!1]})]},n)}),d===t.length?!1:e.jsx("button",{onClick:u,className:"mt-1 option-on w-6 h-6 rounded-sm text:dark-baseColor dark:text-baseColor",children:"+"})]})}function be({month:t,monthIndex:o,translate:a,children:d,calendar:m,setCalendar:f}){const l=i.useRef(!1),[u,s]=i.useState(t.erase||!1),[r,n]=i.useState(t.messages);i.useEffect(()=>{if(!l.current){l.current=!0;return}b()},[u,r]);const b=()=>{const p=m.months.map((g,c)=>c===o?{...g,erase:u,messages:r}:g),h={...m,months:p};f(h)};return e.jsxs(T,{label:E(t.name.split(".")[1].toLowerCase()),labelClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm p-2 text-lg underline cursor-pointer w-full border-b-2 border-accentMedium dark:border-dark-accentMedium",contentClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm p-4 border-b-2  border-accentMedium dark:border-dark-accentMedium w-full  ",initial:!0,children:[e.jsx(y,{labelText:a("removeMonth"),value:u,setValue:s,inputType:"checkbox",inputClassName:"w-4 !m-1 !w-fit !h-fit",inputContainerClassName:" border-b-2 border-baseColor border-dark-baseColor dark:border-accentLight   flex flex-wrap  h-fit cursor-pointer"}),e.jsx(T,{label:a("monthMessages"),labelClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm",initial:!0,children:e.jsx($,{messages:r,setMessages:n,maxMessages:1,translate:a})}),e.jsx(T,{label:a("weeksLabel"),accordionClassName:`text-dark-baseColor bg-accentMedium dark:text-baseColor dark:bg-dark-accentMedium w-full  mt-1  ${u?"cursor-none pointer-events-none [&>*]:!text-red-300 [&>*]:line-through text-ellipsis ":"pointer-events-auto cursor-pointer"}`,labelClassName:"ml-2",contentClassName:"rounded-sm text-dark-baseColor bg-accentMedium dark:text-baseColor dark:bg-dark-accentMedium border-2 border-accentMedium dark:border-dark-accentMedium",initial:!0,children:d})]})}function fe({week:t,weekIndex:o,monthIndex:a,children:d,calendar:m,setCalendar:f,translate:l,fixDate:u,days:s}){const[r,n]=i.useState(t.erase),[b,p]=i.useState(t.messages),[h,g]=i.useState(t.bannedDays),c=i.useRef(!1),x=u(t.days[0].date),k=t.days.length>1?u(t.days[t.days.length-1].date):!1,v=k?x+" : "+k:x;i.useEffect(()=>{if(!c.current){c.current=!0;return}j()},[r,b,h]);const j=()=>{const M=N=>N.map((S,L)=>o!==L?S:{...S,messages:b,erase:r,bannedDays:h}),w=m.months.map((N,S)=>{if(a!==S)return N;const L=M(N.weeks);return{...N,weeks:L}}),C={...m,months:w};f(C)};return t.days.map(M=>E(M.name)),e.jsxs(T,{label:l("weekLabel")+" "+v,labelClassName:" p-2 bg-accentLight dark:bg-dark-accentLight  w-full text-dark-baseColor border-b-2 border-accentMedium dark:border-dark-accentMedium",contentClassName:" p-2 text-dark-baseColor bg-accentMedium dark:text-baseColor dark:bg-dark-accentMedium  w-full text-dark-baseColor border-2 border-accentLight dark:border-dark-accentLight",children:[e.jsx(y,{labelText:l("removeWeek"),value:r,setValue:n,inputType:"checkbox",inputClassName:"w-4 !m-1 !w-fit !h-fit",inputContainerClassName:" border-b-2 border-baseColor border-dark-baseColor dark:border-accentLight   flex flex-wrap  h-fit cursor-pointer"}),e.jsx(T,{label:l("weekBannedDays"),labelClassName:" rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"rounded-sm",initial:!0,children:e.jsx(I,{selectedOptions:h,setSelectedOptions:g,optionsArr:s,translateOption:E})}),e.jsx(T,{label:l("weekMessages"),labelClassName:" rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"rounded-sm mb-2",initial:!0,children:e.jsx($,{messages:b,setMessages:p,translate:l,maxMessages:1})}),e.jsx(T,{label:l("daysLabel"),initial:!0,accordionClassName:` text-dark-baseColor bg-accentLight dark:text-baseColor dark:bg-dark-accentLight w-full  ${r?"cursor-none pointer-events-none [&>*]:!text-red-300 [&>*]:line-through text-ellipsis ":"pointer-events-auto cursor-pointer"}`,contentClassName:"rounded-sm text-dark-baseColor bg-accentMedium dark:text-baseColor dark:bg-dark-accentMedium border-2 border-accentLight dark:border-dark-accentLight",children:d},o)]},o)}function pe({day:t,dayIndex:o,weekIndex:a,monthIndex:d,children:m,calendar:f,setCalendar:l,date:u,translate:s,time:r}){const[n,b]=i.useState(t.erase),[p,h]=i.useState(t.messages),g=i.useRef(!1);i.useEffect(()=>{if(!g.current){g.current=!0;return}c()},[n,p]);const c=()=>{const x=j=>j.map((M,w)=>o!==w?M:{...M,erase:n,messages:p}),k=f.months.map((j,M)=>{if(d!==M)return j;const w=j.weeks.map((C,N)=>{if(a!==N)return C;const S=x(C.days);return{...C,days:S}});return{...j,weeks:w}}),v={...f,months:k};l(v)};return e.jsxs(T,{label:`${E(t.name)}: ${u}`,labelClassName:" p-2 bg-accentMedium dark:bg-dark-accentMedium  w-full text-dark-baseColor border-b-2 ",contentClassName:" p-2  text-dark-baseColor bg-accentLight dark:text-baseColor dark:bg-dark-accentLight  w-full text-dark-baseColor border-2 border-accentMedium dark:border-dark-accentMedium",children:[e.jsx(y,{labelText:s("removeDay"),value:n,setValue:b,inputType:"checkbox",inputClassName:"w-4 !m-1 !w-fit !h-fit",inputContainerClassName:" border-b-2 border-baseColor border-dark-baseColor dark:border-accentLight   flex flex-wrap  h-fit cursor-pointer"}),e.jsx(T,{label:s("dayMessages"),labelClassName:" rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"rounded-sm mb-2",initial:!0,children:e.jsx($,{messages:p,setMessages:h,translate:s,maxMessages:1})}),e.jsx(T,{label:s("columnLabel"),accordionClassName:`${n?"cursor-none pointer-events-none [&>*]:!text-red-300 [&>*]:line-through text-ellipsis ":"pointer-events-auto cursor-pointer"}`,labelClassName:" p-2 bg-accentMedium dark:bg-dark-accentMedium  w-full text-dark-baseColor border-b-2 ",contentClassName:" p-2  text-dark-baseColor bg-accentLight dark:text-baseColor dark:bg-dark-accentLight  w-full text-dark-baseColor border-2 border-accentMedium dark:border-dark-accentMedium ",children:m})]},o)}function xe({column:t,columnIndex:o,dayIndex:a,weekIndex:d,monthIndex:m,children:f,calendar:l,setCalendar:u,translate:s,columns:r}){const[n,b]=i.useState(t.erase),[p,h]=i.useState(t.messages),g=i.useRef(!1);i.useEffect(()=>{if(!g.current){g.current=!0;return}c()},[n,p]);const c=()=>{const x=j=>j.map((M,w)=>o!==w?M:{...M,messages:p,erase:n}),k=l.months.map((j,M)=>{if(m!==M)return j;const w=j.weeks.map((C,N)=>{if(d!==N)return C;const S=C.days.map((L,O)=>{if(a!==O)return L;const D=x(L.columns);return{...L,columns:D}});return{...C,days:S}});return{...j,weeks:w}}),v={...l,months:k};u(v)};return e.jsxs(e.Fragment,{children:[e.jsx(y,{labelText:s("removeColumn"),value:n,setValue:b,inputType:"checkbox",inputClassName:"w-4 !m-1 !w-fit !h-fit",inputContainerClassName:" border-b-2 border-baseColor border-dark-baseColor dark:border-accentLight   flex flex-wrap  h-fit cursor-pointer"}),e.jsx(T,{label:s("columnMessages"),labelClassName:" rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"rounded-sm mb-2",initial:!0,children:e.jsx($,{messages:p,setMessages:h,translate:s,maxMessages:1})}),e.jsx(T,{label:s("slotsLabel"),accordionClassName:`${n?"cursor-none pointer-events-none [&>*]:!text-red-300 [&>*]:line-through text-ellipsis ":"pointer-events-auto cursor-pointer"}`,labelClassName:" p-2 bg-accentMedium dark:bg-dark-accentMedium  w-full text-dark-baseColor border-b-2 ",contentClassName:" p-2  text-dark-baseColor bg-accentLight dark:text-baseColor dark:bg-dark-accentLight  w-full text-dark-baseColor border-2 border-accentMedium dark:border-dark-accentMedium ",children:f})]})}function he({slot:t,slotIndex:o,columnIndex:a,dayIndex:d,weekIndex:m,monthIndex:f,children:l,calendar:u,setCalendar:s,translate:r}){const[n,b]=i.useState(t.erase),[p,h]=i.useState(t.messages),g=i.useRef(!1);i.useEffect(()=>{if(!g.current){g.current=!0;return}c()},[n,p]);const c=()=>{const x=j=>j.map((M,w)=>o!==w?M:{...M,messages:p,erase:n}),k=u.months.map((j,M)=>{if(f!==M)return j;const w=j.weeks.map((C,N)=>{if(m!==N)return C;const S=C.days.map((L,O)=>{if(d!==O)return L;const D=L.columns.map((F,H)=>{if(a!==H)return F;const V=x(F.slots);return{...F,slots:V}});return{...L,columns:D}});return{...C,days:S}});return{...j,weeks:w}}),v={...u,months:k};s(v)};return e.jsxs(e.Fragment,{children:[e.jsx(y,{labelText:r("removeSlot"),value:n,setValue:b,inputType:"checkbox",inputClassName:"w-4 !m-1 !w-fit !h-fit",inputContainerClassName:" border-b-2 border-baseColor border-dark-baseColor dark:border-accentLight   flex flex-wrap  h-fit cursor-pointer"}),e.jsx(T,{label:r("slotMessage"),labelClassName:" rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"rounded-sm mb-2",initial:!0,children:e.jsx($,{messages:p,setMessages:h,translate:r,maxMessages:1})}),e.jsx(T,{label:r("recordsLabel"),accordionClassName:`${n?"cursor-none pointer-events-none [&>*]:!text-red-300 [&>*]:line-through text-ellipsis ":"pointer-events-auto cursor-pointer"}`,labelClassName:" p-2 bg-accentMedium dark:bg-dark-accentMedium  w-full text-dark-baseColor border-b-2 ",contentClassName:" p-2  text-dark-baseColor bg-accentLight dark:text-baseColor dark:bg-dark-accentLight  w-full text-dark-baseColor border-2 border-accentMedium dark:border-dark-accentMedium ",children:l})]})}function ge({record:t,recordIndex:o,slotIndex:a,columnIndex:d,dayIndex:m,weekIndex:f,monthIndex:l,calendar:u,setCalendar:s,translate:r}){const[n,b]=i.useState(t.erase),[p,h]=i.useState(t.messages),[g,c]=i.useState(t.data),x=i.useRef(!1);console.log(t),i.useEffect(()=>{if(!x.current){x.current=!0;return}k()},[n,p]);const k=()=>{const v=w=>w.map((C,N)=>o!==N?C:{...C,messages:p,erase:n}),j=u.months.map((w,C)=>{if(l!==C)return w;const N=w.weeks.map((S,L)=>{if(f!==L)return S;const O=S.days.map((D,F)=>{if(m!==F)return D;const H=D.columns.map((V,R)=>{if(d!==R)return V;const P=V.slots.map((z,A)=>{if(a!==A)return z;const Z=v(z.records);return{...z,records:Z}});return{...V,slots:P}});return{...D,columns:H}});return{...S,days:O}});return{...w,weeks:N}}),M={...u,months:j};s(M)};return e.jsxs("div",{className:"dark:text-baseColor rounded-sm border-accentMedium dark:border-dark-accentMedium border-2 m-2 p-2",children:[e.jsx(y,{labelText:r("userRecord"),value:g,setValue:c,inputType:"text",inputClassName:"w-4 !m-1 !w-full !h-fit",inputContainerClassName:" border-dark-baseColor dark:border-accentLight   flex flex-wrap  h-fit cursor-pointer"}),e.jsx(y,{labelText:r("removeRecord"),value:n,setValue:b,inputType:"checkbox",inputClassName:"w-4 !m-1 !w-fit !h-fit",inputContainerClassName:" border-b-2 border-baseColor border-dark-baseColor dark:border-accentLight   flex flex-wrap  h-fit cursor-pointer"}),e.jsx(T,{label:r("recordMessage"),labelClassName:" rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"rounded-sm mb-2",initial:!0,children:e.jsx($,{messages:p,setMessages:h,maxMessages:1,translate:r})})]})}function ke({translate:t,calendar:o,setCalendar:a}){const d=i.useRef(!1),[m,f]=i.useState(o.messages),[l,u]=i.useState(o.name),[s,r]=i.useState(o.description);i.useEffect(()=>{if(!d.current){d.current=!0;return}n()},[m,l,s]);const n=()=>{a({...o,messages:m,name:l,description:s})};return e.jsxs(T,{label:t("mainSettings"),labelClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm p-2 text-lg underline cursor-pointer w-full border-b-2 border-accentMedium dark:border-dark-accentMedium",contentClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm p-4 border-b-2  border-accentMedium dark:border-dark-accentMedium w-full  ",children:[e.jsx(y,{labelText:t("nameLabel"),value:l,setValue:u,inputType:"text"}),e.jsx(y,{labelText:t("descriptionLabel"),value:s,setValue:r,inputType:"textarea",inputContainerClassName:"mt-2"}),e.jsx(T,{label:t("messagesLabel"),labelClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm",initial:!0,children:e.jsx($,{messages:m,setMessages:f,translate:t,inputContainerClassName:"w-full h-full relative min-w-[full]",inputClassName:"h-full"})})]})}function Ce({calendar:t,setCalendar:o,turnOffConservation:a}){const[d,m]=i.useState(t),[f,l]=i.useState(!1),[u,s]=i.useState(!1),[r,n]=i.useState(!1),[b,p]=i.useState(!1),[h,g]=i.useState(!1),c=C=>E("AdminTools."+C),x=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],k=C=>C.split("T")[0].split("-").reverse().join("-"),v=()=>{o(d),a()},j=()=>{l(!0),ee(t._id,t).then(C=>{setTimeout(()=>{l(!1),C?p(!0):g(!0)},1e3)})},M=()=>{s(!0)},w=()=>{n(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(W,{modalText:c("modalLeave"),buttonText:c("modalButtonLeave"),onClick:v,isOpen:u,setIsOpen:s,onlyButton:!1}),e.jsx(W,{modalText:c("modalSave"),buttonText:c("modalButtonSave"),onClick:j,isOpen:r,setIsOpen:n,onlyButton:!1}),e.jsx(W,{modalText:c("modalApiTrue"),buttonText:c("modalButtonApiTrue"),onClick:a,isOpen:b,setIsOpen:p}),e.jsx(W,{modalText:c("modalApiFalse"),buttonText:c("modalButtonApiFalse"),isOpen:h,setIsOpen:g,onlyButton:!1}),f&&e.jsx(B,{className:"backdrop-blur-sm z-50 flex justify-center items-center",animation:"opacityVariant",children:e.jsx(G,{message:c("loadingApi"),theme:"text-accentStrong",className:"w-fit h-fit"})}),e.jsx(B,{className:"fixed inset-0 z-20 overflow-auto",animation:"xSwipeVariant",children:e.jsx(ue,{className:"bg-accentMedium dark:bg-dark-accentMedium p-2 z-20 w-[400px] overflow-x-hidden h-full right-0 absolute top-0 min-w-[30px]  flex-wrap items-start flex-col",children:e.jsxs("div",{className:"min-w-[400px]",children:[e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:"option-off p-2 rounded-sm border-2 border-accentLight dark:border-dark-accentLight my-2",onClick:w,children:c("buttonSave")}),e.jsx("button",{className:"button-form-reject ml-1 !text-black p-2 rounded-sm border-2 border-accentLight dark:border-dark-accentLight my-2",onClick:M,children:c("buttonLeave")})]}),e.jsxs("div",{className:" w-full flex-row flex-wrap ",children:[e.jsx(ke,{translate:c,calendar:t,setCalendar:o}),t.months.map((C,N)=>e.jsx(be,{month:C,translate:c,days:x,monthIndex:N,calendar:t,setCalendar:o,children:C.weeks.map((S,L)=>e.jsx(fe,{week:S,weekIndex:L,monthIndex:N,calendar:t,setCalendar:o,translate:c,fixDate:k,days:x,children:S.days.map((O,D)=>{const F=k(O.date);return e.jsx(pe,{day:O,monthIndex:N,weekIndex:L,dayIndex:D,calendar:t,setCalendar:o,translate:c,date:F,time:S.time,children:O.columns.map((H,V)=>e.jsx(xe,{column:H,columnIndex:V,monthIndex:N,weekIndex:L,dayIndex:D,calendar:t,setCalendar:o,translate:c,columns:O.columns.map(R=>R.name),children:H.slots.map((R,P)=>e.jsx(he,{slot:R,slotIndex:P,columnIndex:V,monthIndex:N,weekIndex:L,dayIndex:D,calendar:t,setCalendar:o,translate:c,children:R.records.map((z,A)=>e.jsx(ge,{record:z,recordIndex:A,slotIndex:P,columnIndex:V,monthIndex:N,weekIndex:L,dayIndex:D,calendar:t,setCalendar:o,translate:c},A))},P))},V))},D)})},L))},N))]})]})})})]})}function Ne(){const t=te(),o=ae(),{isAdmin:a}=X(),{socket:d,setConservation:m,compareSocketId:f}=K(),l=t.pathname.split("/").pop(),[u,s]=i.useState(0),[r,n]=i.useState(!1),b=x=>{const k=v=>JSON.parse(JSON.stringify(v.replaceAll(" ","_").normalize("NFD").replace(/[\u0300-\u036f]/g,"")));for(let v=0;v<x.length;v++)if(k(x[v].name)===k(l))return x[v];return!1},p=i.useMemo(()=>{const x=t.state;if(x){const k=b([x]);return k||!1}else return!1},[]),[h,g]=i.useState(p);i.useEffect(()=>(h||se().then(x=>{const k=b(x);if(k){setTimeout(()=>{g(k)},1e3);return}else setTimeout(()=>{o("/brak_strony",{state:t.pathname})},500)}),()=>{window.history.replaceState({},document.title)}),[]);const c=()=>{m(h._id,!h.conservation),g({...h,conservation:!h.conservation})};return i.useEffect(()=>{d&&d.on("conservation",x=>{x.calendarId===h._id&&!f(x.senderId)&&n(!0)})},[]),console.log(h),e.jsx(e.Fragment,{children:e.jsx(B,{className:"background flex justify-center items-start overflow-hidden",animation:"opacityVariant",children:e.jsxs(_,{mode:"wait",children:[a&&h.conservation?e.jsx(Ce,{turnOffConservation:c,calendar:h,setCalendar:g}):e.jsx("button",{className:"absolute right-0 z-[100]",onClick:c,children:"click"}),e.jsx(W,{isOpen:h.conservation&&!a?!0:r,modalText:E("modalTextConservation"),buttonText:E("modalButtonText"),setIsOpen:n,onClick:()=>o("/")}),e.jsx(re,{}),h?e.jsx(e.Fragment,{children:e.jsxs(B,{className:"relative w-full h-full flex justify-center flex-wrap",animation:"opacityVariant",children:[e.jsx("h3",{className:"custom-text-accentStrong text-center text-xl w-full underline font-bold md:pt-4 pt-4 ",children:h.name}),e.jsx(ne,{className:"w-11/12 md:w-3/4 h-5/6 md:h-3/4 md:-mt-28 -mt-4 rounded-sm",containerClassName:"w-full h-full bg-accentMedium dark:bg-dark-accentMedium",startPosition:0,pages:h.months.map((x,k)=>e.jsx(de,{month:x,calendarId:h._id,swipe:u,maxIndex:h.months.length-1,setSwipe:s},x._id)),swipeToIndex:u},"carosuel")]},"calendarPage")}):e.jsx(G,{message:E("loading"),theme:"text-accentStrong dark:text-dark-accentStrong ",className:" self-center"})]})},"calendarPageContainer")})}export{Ne as default};
