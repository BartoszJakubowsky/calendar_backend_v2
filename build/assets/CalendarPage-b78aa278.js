import{r as c,j as e,A as _,a as B,F as Z,S as q,u as X,t as E,m as J,I as Q,L as T,b as y,c as I,d as G,e as ee,f as te,g as ae,h as se,i as re,M as ne,C as oe}from"./index-a662c126.js";function W({modalText:t,buttonText:r,onClick:a,isOpen:i,setIsOpen:x,onlyButton:h=!0}){const l={type:"spring",stiffness:700,damping:30};c.useEffect(()=>{const n=o=>{o.keyCode===27&&s()};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[]);const u=()=>{a&&a(),x(!1)},s=()=>{h||x(!1)};return e.jsx(_,{mode:"wait",children:i?e.jsx(B,{onClick:s,animation:"opacityVariant",transition:{duration:.2},className:"fixed inset-0 bg-opacity-80 duration-200 transition-all bg-gray-900 z-50 flex justify-center items-center",children:e.jsxs(B,{transition:l,animation:"scaleVariant",className:"relative w-80 rounded-sm h-60 bg-red-100 mb-3/4 background p-4 overflow-hidden text-lg flex flex-wrap flex-col",children:[t,e.jsx(Z,{onClick:u,text:r,className:"!w-fit !self-end mt-auto mb-2"})]})}):!1})}function le({days:t,bannedData:r,rowClassName:a,cellClassName:i,additionalFirstCol:x,translate:h}){const l=t.filter(s=>!r.includes(s.name.toUpperCase())),u=l.length>0?l.map(s=>{if(s.erase||(m=>{const b=m.toUpperCase();return r.includes(b)})(s.name))return!1;const o=s.date.split("T")[0].split("-").reverse().join("-");return e.jsxs("th",{className:`${i} flex flex-col grow bg-accentMedium dark:bg-dark-accentMedium text-dark-baseColor dark:text-baseColor font-medium`,children:[e.jsx("h3",{className:"pb-1",children:h(s.name)}),e.jsx("h4",{children:o}),e.jsx("div",{className:"flex justify-evenly overflow-hidden",children:s.columns.map(m=>e.jsx("h4",{className:"h-14 w-16 text-sm text-center",children:m.name},m.id))})]},s.id)}):!1;return e.jsx(e.Fragment,{children:u?e.jsxs("tr",{className:`${a} sticky top-0 z-[6]`,children:[x?e.jsx("th",{className:`${i}  sticky -left-[1px] w-16  bg-accentLight dark:bg-dark-accentLight text-dark-baseColor dark:text-baseColor`,children:h(x)}):!1,u]}):!1})}function K(){return c.useContext(q)}function de({record:t,translate:r,calendarId:a,date:i,time:x}){const{user:h}=X(),{socket:l,updateRecord:u}=K(),[s,n]=c.useState(t.data),o=t.id,[m,b]=c.useState(!1),g=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],f=new Date(i),p=g[f.getUTCDay()],d=()=>{const j=f.getUTCDate().toString().padStart(2,"0"),C=(f.getUTCMonth()+1).toString().padStart(2,"0"),M=f.getUTCFullYear();return`${j}-${C}-${M}`},k=j=>{j.recordId===o&&n(j.data)};c.useEffect(()=>{l&&l.on("sign",j=>k(j))},[]);const N=()=>{b(r(s===""?"sign":"sign_out"))},v=()=>{b(!1)},w=()=>{u({recordId:o,calendarId:a,data:s===""?h.name:"",userId:h._id,date:{fullDate:d(),dayName:p,time:x}}),s===""?b(!1):N()};return e.jsx("button",{className:`${s===""?"dark:bg-dark-accentLight bg-accentLight ":"bg-accentMedium dark:bg-dark-accentMedium"}
         hover:bg-accentMedium dark:hover:bg-dark-accentStrongHover w-24 h-14 hover:shadow-lg transition-all active:bg-accentStrong dark:active:bg-dark-accentStrong active:text-baseColor duration-200 grow rounded-sm border-[1px] border-slate-700 m-1 overflow-hidden`,onMouseEnter:N,onMouseLeave:v,onClick:w,children:m||s})}function A({message:t,hide:r,...a}){if(r)return!1;const i=t.data,x=t.date,h=t.time;function l(s){const n=new Date("2023-08-31T22:00:00.000Z"),o=new Date(s);if(h){const[m,b]=h.split(":");o.inputDateTime.setUTCHours(m,b,0,0)}return o<n}return i==""||x&&l(x)?!1:e.jsx("div",{className:`${a.className?a.className:""} z-[1] inset-0 absolute flex justify-center items-center bg-accentMedium dark:a rounded-md border-2 border-accentStrong dark:border-dark-accentStrong`,children:e.jsx("p",{className:`${a.className?"":"sticky top-1/4 bottom-1/2 left-1/4 -translate-x-1/4"} text-center`,children:i})})}function ce({days:t,bannedDays:r,rowClassName:a,cellClassName:i,time:x,translate:h,index:l,calendarId:u,weekMessage:s}){const n=(f,p)=>f.map(d=>e.jsx(de,{record:d,translate:h,calendarId:u,date:p,time:x},d.id)),o=(f,p)=>{const d=f.map((k,N)=>{if(N===l)return e.jsx("div",{className:"flex flex-col items-center justify-center relative",children:n(k.records,p)},k.id)});return e.jsx(e.Fragment,{children:d})},m=(f,p)=>f.map(d=>e.jsxs("div",{className:"flex relative",children:[d.messages.length>0&&e.jsx(A,{className:"flex z-[2]",message:d.messages[0],isVisible:s}),o(d.slots,p)]},d.id)),b=t.filter(f=>!r.includes(f.name.toUpperCase())),g=b.length>0?b.map(f=>f.erase?!1:e.jsxs("td",{className:`${i} flex flex-row grow relative`,children:[f.messages.length>0&&e.jsx(A,{className:"flex z-[3]",message:f.messages[0],hide:s}),m(f.columns,f.date)]},f.id)):!1;return e.jsx(e.Fragment,{children:g?e.jsxs("tr",{className:`${a} relative`,children:[e.jsx("td",{className:`${i}border-l-0 border-r-2 sticky z-[5] -left-[1px] w-16 bg-accentLight dark:bg-dark-accentLight text-dark-baseColor dark:text-baseColor justify-center flex items-center`,children:e.jsx("span",{className:"sticky top-28",children:x})}),g]}):!1})}function ie({week:t,calendarId:r}){const{days:a,bannedDays:i,time:x,messages:h,erase:l}=t;return l?!1:e.jsxs("table",{className:"relative",children:[h.length>0&&e.jsx(A,{message:h[0]}),e.jsxs("tbody",{children:[e.jsx(le,{rowClassName:"flex flex-row",cellClassName:"bg-accentLight dark:bg-accentLight border-2 border-slate-700",days:a,bannedData:i,additionalFirstCol:"time",translate:E}),x.map((u,s)=>e.jsx(ce,{index:s,rowClassName:"flex flex-row",cellClassName:"bg-accentLight dark:bg-dark-accentLight border-2 border-slate-700 text-dark-baseColor dark:text-baseColor",days:a,bannedDays:i,time:u,translate:E,calendarId:r,weekMessage:h.length>0},u))]})]})}function ue({month:t,swipe:r,setSwipe:a,maxIndex:i,calendarId:x}){const[h,l]=t.name.split(".").map(m=>m.toLowerCase()),u=t.messages.map((m,b)=>e.jsx(A,{message:m},b)),s=()=>{a(r-1)},n=()=>{a(r+1)},o=t.weeks.map((m,b)=>e.jsx(ie,{week:m,calendarId:x},b));return e.jsxs("div",{className:"overflow-hidden w-full h-full border-2 border-slate-700 relative",children:[u,e.jsxs("h3",{className:"relative text-lg w-full md:h-[4%] h-[5%] text-center bg-accentStrongHover dark:bg-dark-accentStrongHover text-baseColor dark:text-baseColor",children:[E(l),e.jsx("button",{onClick:s,className:`absolute text-sm left-1 top-1 transition-all duration-200 ${r===0?" opacity-50 pointer-events-none":""}`,children:E("previousMonth")}),e.jsx("button",{onClick:n,className:`absolute text-sm right-1 top-1 transition-all duration-200 ${r===i?"opacity-50 pointer-events-none":""}`,children:E("nextMonth")})]}),e.jsx("div",{className:"flex flex-wrap flex-col md:h-[96%] h-[95%] w-full overflow-auto touch-auto bg-red-300",children:o})]})}function me({children:t,...r}){var n,o;const a=c.useRef(null),i=(n=a==null?void 0:a.current)!=null&&n.clientHeight?a.current.clientHeight:0,x=(o=a==null?void 0:a.current)!=null&&o.clientWidth?a.current.clientWidth:0,[h,l]=c.useState(!1),u=m=>{a.current.style.width=`${(h||x)-m}px`},s=()=>{l(a.current.clientWidth)};return e.jsxs(J.div,{ref:a,className:r.className,drag:"x",dragConstraints:{top:0,left:0,right:0,bottom:window.innerHeight-i},dragMomentum:!1,dragElastic:.05,children:[t,e.jsx(be,{className:"absolute bottom-1/2 top-1/2 -left-2 py-10 px-4 ",handleDragEnd:s,handleResize:u})]})}function be({handleResize:t,handleDragEnd:r,...a}){let i;return e.jsx(J.div,{className:a.className,drag:"x",dragConstraints:{left:0,right:0,top:0,bottom:0},dragMomentum:!1,onDragEnd:()=>r(),dragElastic:1e-4,onDrag:(x,h)=>{const l=()=>{const s=h.offset.x;return i===s?!1:s};(()=>{const s=l();s&&(i=s,t(s,"x"))})()},children:e.jsx(Q,{className:" rotate-90 cursor-ew-resize"})})}function $({messages:t,setMessages:r,boundaryArray:a,maxMessages:i,translate:x,...h}){const l=(n,o)=>{const m=t.map((b,g)=>g!==o?b:n);r(m)},u=()=>{const n={data:"",expires:{date:"",time:""},from:a?0:!1,to:a?a.length-1:!1};t.length===0?r([n]):r([...t,n])},s=n=>{r(t.filter((o,m)=>m!==n))};return e.jsxs("div",{className:`${h.className}`,children:[t.length>0&&t.map((n,o)=>{const m=d=>{const k={...n,data:d};l(k,o)},b=d=>{const k={...n,expires:{...n.expires,date:d}};l(k,o)},g=d=>{const k={...n,expires:{...n.expires,time:d}};l(k,o)},f=d=>{const k=a.indexOf(d),N={...n,from:k};l(N,o)},p=d=>{const k=a.indexOf(d),N={...n,to:k};l(N,o)};return e.jsxs("div",{className:"flex w-full flex-row",children:[e.jsxs("div",{className:"relative w-2/3  mr-2 mb-2",children:[e.jsx(T,{inputType:"textarea",inputContainerClassName:"w-full h-full relative min-w-[full]",inputClassName:"h-full",value:n.data,setValue:m,placeHolder:x("monthMessagePlaceholder")}),e.jsx("button",{onClick:()=>s(o),className:"flex justify-center absolute right-1 top-3 button-form-reject w-6 h-6 rounded-sm text:dark-baseColor dark:text-baseColor",children:"-"})]}),e.jsxs("div",{className:"flex flex-col w-1/3",children:[e.jsx(T,{inputType:"date",inputClassName:"w-full",value:n.expires.date,setValue:b}),e.jsx(T,{inputType:"time",inputClassName:"w-full",value:n.expires.time,setValue:g}),a?e.jsxs("div",{className:"flex w-full h-10",children:[e.jsx(T,{inputType:"list",inputContainerClassName:"mr-1",valueList:a,value:0,setValue:f}),e.jsx(T,{inputType:"list",inputContainerClassName:"ml-1",valueList:a,value:a.length-1,setValue:p})]}):!1]})]},o)}),i===t.length?!1:e.jsx("button",{onClick:u,className:"mt-1 option-on w-6 h-6 rounded-sm text:dark-baseColor dark:text-baseColor",children:"+"})]})}function fe({month:t,monthIndex:r,translate:a,children:i,calendar:x,setCalendar:h}){const l=c.useRef(!1),[u,s]=c.useState(t.erase||!1),[n,o]=c.useState(t.messages);c.useEffect(()=>{if(!l.current){l.current=!0;return}m()},[u,n]);const m=()=>{const b=x.months.map((f,p)=>p===r?{...f,erase:u,messages:n}:f),g={...x,months:b};h(g)};return e.jsxs(y,{label:E(t.name.split(".")[1].toLowerCase()),labelClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm p-2 text-lg underline cursor-pointer w-full border-b-2 border-accentMedium dark:border-dark-accentMedium",contentClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm p-4 border-b-2  border-accentMedium dark:border-dark-accentMedium w-full  ",initial:!0,children:[e.jsx(T,{labelText:a("removeMonth"),value:u,setValue:s,inputType:"checkbox",inputClassName:"w-4 !m-1 !w-fit !h-fit",inputContainerClassName:" border-b-2 border-baseColor border-dark-baseColor dark:border-accentLight   flex flex-wrap  h-fit cursor-pointer"}),e.jsx(y,{label:a("monthMessages"),labelClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm",initial:!0,children:e.jsx($,{messages:n,setMessages:o,maxMessages:1,translate:a})}),e.jsx(y,{label:a("weeksLabel"),accordionClassName:`text-dark-baseColor bg-accentMedium dark:text-baseColor dark:bg-dark-accentMedium w-full  mt-1  ${u?"cursor-none pointer-events-none [&>*]:!text-red-300 [&>*]:line-through text-ellipsis ":"pointer-events-auto cursor-pointer"}`,labelClassName:"ml-2",contentClassName:"rounded-sm text-dark-baseColor bg-accentMedium dark:text-baseColor dark:bg-dark-accentMedium border-2 border-accentMedium dark:border-dark-accentMedium",initial:!0,children:i})]})}function pe({week:t,weekIndex:r,monthIndex:a,children:i,calendar:x,setCalendar:h,translate:l,fixDate:u,days:s}){const[n,o]=c.useState(t.erase),[m,b]=c.useState(t.messages),[g,f]=c.useState(t.bannedDays),p=c.useRef(!1),d=u(t.days[0].date),k=t.days.length>1?u(t.days[t.days.length-1].date):!1,N=k?d+" : "+k:d;c.useEffect(()=>{if(!p.current){p.current=!0;return}v()},[n,m,g]);const v=()=>{const w=M=>M.map((S,L)=>r!==L?S:{...S,messages:m,erase:n,bannedDays:g}),j=x.months.map((M,S)=>{if(a!==S)return M;const L=w(M.weeks);return{...M,weeks:L}}),C={...x,months:j};h(C)};return t.days.map(w=>E(w.name)),e.jsxs(y,{label:l("weekLabel")+" "+N,labelClassName:" p-2 bg-accentLight dark:bg-dark-accentLight  w-full text-dark-baseColor border-b-2 border-accentMedium dark:border-dark-accentMedium",contentClassName:" p-2 text-dark-baseColor bg-accentMedium dark:text-baseColor dark:bg-dark-accentMedium  w-full text-dark-baseColor border-2 border-accentLight dark:border-dark-accentLight",children:[e.jsx(T,{labelText:l("removeWeek"),value:n,setValue:o,inputType:"checkbox",inputClassName:"w-4 !m-1 !w-fit !h-fit",inputContainerClassName:" border-b-2 border-baseColor border-dark-baseColor dark:border-accentLight   flex flex-wrap  h-fit cursor-pointer"}),e.jsx(y,{label:l("weekBannedDays"),labelClassName:" rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"rounded-sm",initial:!0,children:e.jsx(I,{selectedOptions:g,setSelectedOptions:f,optionsArr:s,translateOption:E})}),e.jsx(y,{label:l("weekMessages"),labelClassName:" rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"rounded-sm mb-2",initial:!0,children:e.jsx($,{messages:m,setMessages:b,translate:l,maxMessages:1})}),e.jsx(y,{label:l("daysLabel"),initial:!0,accordionClassName:` text-dark-baseColor bg-accentLight dark:text-baseColor dark:bg-dark-accentLight w-full  ${n?"cursor-none pointer-events-none [&>*]:!text-red-300 [&>*]:line-through text-ellipsis ":"pointer-events-auto cursor-pointer"}`,contentClassName:"rounded-sm text-dark-baseColor bg-accentMedium dark:text-baseColor dark:bg-dark-accentMedium border-2 border-accentLight dark:border-dark-accentLight",children:i},r)]},r)}function xe({day:t,dayIndex:r,weekIndex:a,monthIndex:i,children:x,calendar:h,setCalendar:l,date:u,translate:s,time:n}){const[o,m]=c.useState(t.erase),[b,g]=c.useState(t.messages),f=c.useRef(!1);c.useEffect(()=>{if(!f.current){f.current=!0;return}p()},[o,b]);const p=()=>{const d=v=>v.map((w,j)=>r!==j?w:{...w,erase:o,messages:b}),k=h.months.map((v,w)=>{if(i!==w)return v;const j=v.weeks.map((C,M)=>{if(a!==M)return C;const S=d(C.days);return{...C,days:S}});return{...v,weeks:j}}),N={...h,months:k};l(N)};return e.jsxs(y,{label:`${E(t.name)}: ${u}`,labelClassName:" p-2 bg-accentMedium dark:bg-dark-accentMedium  w-full text-dark-baseColor border-b-2 ",contentClassName:" p-2  text-dark-baseColor bg-accentLight dark:text-baseColor dark:bg-dark-accentLight  w-full text-dark-baseColor border-2 border-accentMedium dark:border-dark-accentMedium",children:[e.jsx(T,{labelText:s("removeDay"),value:o,setValue:m,inputType:"checkbox",inputClassName:"w-4 !m-1 !w-fit !h-fit",inputContainerClassName:" border-b-2 border-baseColor border-dark-baseColor dark:border-accentLight   flex flex-wrap  h-fit cursor-pointer"}),e.jsx(y,{label:s("dayMessages"),labelClassName:" rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"rounded-sm mb-2",initial:!0,children:e.jsx($,{messages:b,setMessages:g,translate:s,maxMessages:1})}),e.jsx(y,{label:s("columnLabel"),accordionClassName:`${o?"cursor-none pointer-events-none [&>*]:!text-red-300 [&>*]:line-through text-ellipsis ":"pointer-events-auto cursor-pointer"}`,labelClassName:" p-2 bg-accentMedium dark:bg-dark-accentMedium  w-full text-dark-baseColor border-b-2 ",contentClassName:" p-2  text-dark-baseColor bg-accentLight dark:text-baseColor dark:bg-dark-accentLight  w-full text-dark-baseColor border-2 border-accentMedium dark:border-dark-accentMedium ",children:x})]},r)}function he({column:t,columnIndex:r,dayIndex:a,weekIndex:i,monthIndex:x,children:h,calendar:l,setCalendar:u,translate:s,columns:n}){const[o,m]=c.useState(t.erase),[b,g]=c.useState(t.messages),f=c.useRef(!1);c.useEffect(()=>{if(!f.current){f.current=!0;return}p()},[o,b]);const p=()=>{const d=v=>v.map((w,j)=>r!==j?w:{...w,messages:b,erase:o}),k=l.months.map((v,w)=>{if(x!==w)return v;const j=v.weeks.map((C,M)=>{if(i!==M)return C;const S=C.days.map((L,O)=>{if(a!==O)return L;const D=d(L.columns);return{...L,columns:D}});return{...C,days:S}});return{...v,weeks:j}}),N={...l,months:k};u(N)};return e.jsxs(e.Fragment,{children:[e.jsx(T,{labelText:s("removeColumn"),value:o,setValue:m,inputType:"checkbox",inputClassName:"w-4 !m-1 !w-fit !h-fit",inputContainerClassName:" border-b-2 border-baseColor border-dark-baseColor dark:border-accentLight   flex flex-wrap  h-fit cursor-pointer"}),e.jsx(y,{label:s("columnMessages"),labelClassName:" rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"rounded-sm mb-2",initial:!0,children:e.jsx($,{messages:b,setMessages:g,translate:s,maxMessages:1})}),e.jsx(y,{label:s("slotsLabel"),accordionClassName:`${o?"cursor-none pointer-events-none [&>*]:!text-red-300 [&>*]:line-through text-ellipsis ":"pointer-events-auto cursor-pointer"}`,labelClassName:" p-2 bg-accentMedium dark:bg-dark-accentMedium  w-full text-dark-baseColor border-b-2 ",contentClassName:" p-2  text-dark-baseColor bg-accentLight dark:text-baseColor dark:bg-dark-accentLight  w-full text-dark-baseColor border-2 border-accentMedium dark:border-dark-accentMedium ",children:h})]})}function ge({slot:t,slotIndex:r,columnIndex:a,dayIndex:i,weekIndex:x,monthIndex:h,children:l,calendar:u,setCalendar:s,translate:n}){const[o,m]=c.useState(t.erase),[b,g]=c.useState(t.messages),f=c.useRef(!1);c.useEffect(()=>{if(!f.current){f.current=!0;return}p()},[o,b]);const p=()=>{const d=v=>v.map((w,j)=>r!==j?w:{...w,messages:b,erase:o}),k=u.months.map((v,w)=>{if(h!==w)return v;const j=v.weeks.map((C,M)=>{if(x!==M)return C;const S=C.days.map((L,O)=>{if(i!==O)return L;const D=L.columns.map((V,H)=>{if(a!==H)return V;const F=d(V.slots);return{...V,slots:F}});return{...L,columns:D}});return{...C,days:S}});return{...v,weeks:j}}),N={...u,months:k};s(N)};return e.jsxs(e.Fragment,{children:[e.jsx(T,{labelText:n("removeSlot"),value:o,setValue:m,inputType:"checkbox",inputClassName:"w-4 !m-1 !w-fit !h-fit",inputContainerClassName:" border-b-2 border-baseColor border-dark-baseColor dark:border-accentLight   flex flex-wrap  h-fit cursor-pointer"}),e.jsx(y,{label:n("slotMessage"),labelClassName:" rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"rounded-sm mb-2",initial:!0,children:e.jsx($,{messages:b,setMessages:g,translate:n,maxMessages:1})}),e.jsx(y,{label:n("recordsLabel"),accordionClassName:`${o?"cursor-none pointer-events-none [&>*]:!text-red-300 [&>*]:line-through text-ellipsis ":"pointer-events-auto cursor-pointer"}`,labelClassName:" p-2 bg-accentMedium dark:bg-dark-accentMedium  w-full text-dark-baseColor border-b-2 ",contentClassName:" p-2  text-dark-baseColor bg-accentLight dark:text-baseColor dark:bg-dark-accentLight  w-full text-dark-baseColor border-2 border-accentMedium dark:border-dark-accentMedium ",children:l})]})}function ke({record:t,recordIndex:r,slotIndex:a,columnIndex:i,dayIndex:x,weekIndex:h,monthIndex:l,calendar:u,setCalendar:s,translate:n}){const[o,m]=c.useState(t.erase),[b,g]=c.useState(t.messages),[f,p]=c.useState(t.data),d=c.useRef(!1);console.log(t),c.useEffect(()=>{if(!d.current){d.current=!0;return}k()},[o,b]);const k=()=>{const N=j=>j.map((C,M)=>r!==M?C:{...C,messages:b,erase:o}),v=u.months.map((j,C)=>{if(l!==C)return j;const M=j.weeks.map((S,L)=>{if(h!==L)return S;const O=S.days.map((D,V)=>{if(x!==V)return D;const H=D.columns.map((F,R)=>{if(i!==R)return F;const U=F.slots.map((P,z)=>{if(a!==z)return P;const Y=N(P.records);return{...P,records:Y}});return{...F,slots:U}});return{...D,columns:H}});return{...S,days:O}});return{...j,weeks:M}}),w={...u,months:v};s(w)};return e.jsxs("div",{className:"dark:text-baseColor rounded-sm border-accentMedium dark:border-dark-accentMedium border-2 m-2 p-2",children:[e.jsx(T,{labelText:n("userRecord"),value:f,setValue:p,inputType:"text",inputClassName:"w-4 !m-1 !w-full !h-fit",inputContainerClassName:" border-dark-baseColor dark:border-accentLight   flex flex-wrap  h-fit cursor-pointer"}),e.jsx(T,{labelText:n("removeRecord"),value:o,setValue:m,inputType:"checkbox",inputClassName:"w-4 !m-1 !w-fit !h-fit",inputContainerClassName:" border-b-2 border-baseColor border-dark-baseColor dark:border-accentLight   flex flex-wrap  h-fit cursor-pointer"}),e.jsx(y,{label:n("recordMessage"),labelClassName:" rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"rounded-sm mb-2",initial:!0,children:e.jsx($,{messages:b,setMessages:g,maxMessages:1,translate:n})})]})}function Ce({translate:t,calendar:r,setCalendar:a}){const i=c.useRef(!1),[x,h]=c.useState(r.messages),[l,u]=c.useState(r.name),[s,n]=c.useState(r.description);c.useEffect(()=>{if(!i.current){i.current=!0;return}o()},[x,l,s]);const o=()=>{a({...r,messages:x,name:l,description:s})};return e.jsxs(y,{label:t("mainSettings"),labelClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm p-2 text-lg underline cursor-pointer w-full border-b-2 border-accentMedium dark:border-dark-accentMedium",contentClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm p-4 border-b-2  border-accentMedium dark:border-dark-accentMedium w-full  ",children:[e.jsx(T,{labelText:t("nameLabel"),value:l,setValue:u,inputType:"text"}),e.jsx(T,{labelText:t("descriptionLabel"),value:s,setValue:n,inputType:"textarea",inputContainerClassName:"mt-2"}),e.jsx(y,{label:t("messagesLabel"),labelClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm mt-1 dark:text-baseColor font-medium cursor-pointer",contentClassName:"bg-accentLight dark:bg-dark-accentLight rounded-sm",initial:!0,children:e.jsx($,{messages:x,setMessages:h,translate:t,inputContainerClassName:"w-full h-full relative min-w-[full]",inputClassName:"h-full"})})]})}function je({calendar:t,setCalendar:r,turnOffConservation:a}){const[i,x]=c.useState(t),[h,l]=c.useState(!1),[u,s]=c.useState(!1),[n,o]=c.useState(!1),[m,b]=c.useState(!1),[g,f]=c.useState(!1),p=C=>E("AdminTools."+C),d=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],k=C=>C.split("T")[0].split("-").reverse().join("-"),N=()=>{r(i),a()},v=()=>{l(!0),ee(t._id,t).then(C=>{setTimeout(()=>{l(!1),C?b(!0):f(!0)},1e3)})},w=()=>{s(!0)},j=()=>{o(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(W,{modalText:p("modalLeave"),buttonText:p("modalButtonLeave"),onClick:N,isOpen:u,setIsOpen:s,onlyButton:!1}),e.jsx(W,{modalText:p("modalSave"),buttonText:p("modalButtonSave"),onClick:v,isOpen:n,setIsOpen:o,onlyButton:!1}),e.jsx(W,{modalText:p("modalApiTrue"),buttonText:p("modalButtonApiTrue"),onClick:a,isOpen:m,setIsOpen:b}),e.jsx(W,{modalText:p("modalApiFalse"),buttonText:p("modalButtonApiFalse"),isOpen:g,setIsOpen:f,onlyButton:!1}),h&&e.jsx(B,{className:"backdrop-blur-sm z-50 flex justify-center items-center",animation:"opacityVariant",children:e.jsx(G,{message:p("loadingApi"),theme:"text-accentStrong dark:text-dark-accentStrong",className:"w-fit h-fit"})}),e.jsx(B,{className:"fixed inset-0 z-20 overflow-auto",animation:"xSwipeVariant",children:e.jsx(me,{className:"bg-accentMedium dark:bg-dark-accentMedium p-2 z-50 w-10/12 md:w-[400px] overflow-x-hidden h-full max-w-full right-0 absolute top-0 min-w-[30px]  flex-wrap items-start flex-col",children:e.jsxs("div",{className:"md:min-w-[400px] min-w-[300px]",children:[e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:"option-off p-2 rounded-sm border-2 border-accentLight dark:border-dark-accentLight my-2",onClick:j,children:p("buttonSave")}),e.jsx("button",{className:"button-form-reject ml-1 !text-black p-2 rounded-sm border-2 border-accentLight dark:border-dark-accentLight my-2",onClick:w,children:p("buttonLeave")})]}),e.jsxs("div",{className:" w-full flex-row flex-wrap ",children:[e.jsx(Ce,{translate:p,calendar:t,setCalendar:r}),t.months.map((C,M)=>e.jsx(fe,{month:C,translate:p,days:d,monthIndex:M,calendar:t,setCalendar:r,children:C.weeks.map((S,L)=>e.jsx(pe,{week:S,weekIndex:L,monthIndex:M,calendar:t,setCalendar:r,translate:p,fixDate:k,days:d,children:S.days.map((O,D)=>{const V=k(O.date);return e.jsx(xe,{day:O,monthIndex:M,weekIndex:L,dayIndex:D,calendar:t,setCalendar:r,translate:p,date:V,time:S.time,children:O.columns.map((H,F)=>e.jsx(he,{column:H,columnIndex:F,monthIndex:M,weekIndex:L,dayIndex:D,calendar:t,setCalendar:r,translate:p,columns:O.columns.map(R=>R.name),children:H.slots.map((R,U)=>e.jsx(ge,{slot:R,slotIndex:U,columnIndex:F,monthIndex:M,weekIndex:L,dayIndex:D,calendar:t,setCalendar:r,translate:p,children:R.records.map((P,z)=>e.jsx(ke,{record:P,recordIndex:z,slotIndex:U,columnIndex:F,monthIndex:M,weekIndex:L,dayIndex:D,calendar:t,setCalendar:r,translate:p},z))},U))},F))},D)})},L))},M))]})]})})})]})}function ve(){const t=te(),r=ae(),{isAdmin:a}=X(),{socket:i,setConservation:x,compareSocketId:h}=K(),l=t.pathname.split("/").pop(),[u,s]=c.useState(0),[n,o]=c.useState(!1),m=d=>{const k=N=>JSON.parse(JSON.stringify(N.replaceAll(" ","_").normalize("NFD").replace(/[\u0300-\u036f]/g,"")));for(let N=0;N<d.length;N++)if(k(d[N].name)===k(l))return d[N];return!1},b=c.useMemo(()=>{const d=t.state;if(d){const k=m([d]);return k||!1}else return!1},[]),[g,f]=c.useState(b);c.useEffect(()=>(g||se().then(d=>{const k=m(d);if(k){setTimeout(()=>{f(k)},1e3);return}else setTimeout(()=>{r("/brak_strony",{state:t.pathname})},500)}),()=>{window.history.replaceState({},document.title)}),[]);const p=()=>{x(g._id,!g.conservation),f({...g,conservation:!g.conservation})};return c.useEffect(()=>{i&&i.on("conservation",d=>{d.calendarId===g._id&&!h(d.senderId)&&o(!0)})},[]),console.log(g),e.jsx(e.Fragment,{children:e.jsx(B,{className:"background flex justify-center items-start overflow-hidden",animation:"opacityVariant",children:e.jsxs(_,{mode:"wait",children:[a&&g.conservation?e.jsx(je,{turnOffConservation:p,calendar:g,setCalendar:f}):e.jsx("button",{className:"absolute right-0 z-[20]",onClick:p,children:e.jsx(re,{className:"text-accentStrong dark:text-dark-accentStrong"})}),e.jsx(W,{isOpen:g.conservation&&!a?!0:n,modalText:E("modalTextConservation"),buttonText:E("modalButtonText"),setIsOpen:o,onClick:()=>r("/")}),e.jsx(ne,{}),g?e.jsx(e.Fragment,{children:e.jsxs(B,{className:"relative w-full h-full flex justify-center flex-wrap",animation:"opacityVariant",children:[e.jsx("h3",{className:"custom-text-accentStrong text-center text-xl w-full underline font-bold md:pt-4 pt-4 ",children:g.name}),e.jsx(oe,{className:"w-11/12 md:w-3/4 h-5/6 md:h-3/4 md:-mt-28 -mt-4 rounded-sm",containerClassName:"w-full h-full bg-accentMedium dark:bg-dark-accentMedium",startPosition:0,pages:g.months.map((d,k)=>e.jsx(ue,{month:d,calendarId:g._id,swipe:u,maxIndex:g.months.length-1,setSwipe:s},d._id)),swipeToIndex:u},"carosuel")]},"calendarPage")}):e.jsx(G,{message:E("loading"),theme:"text-accentStrong dark:text-dark-accentStrong ",className:" self-center"})]})},"calendarPageContainer")})}export{ve as default};
